# Example Cache Module Configuration
# This file shows various configuration examples for different scenarios

# ============================================================================
# Example 1: Simple Local Cache for Development
# ============================================================================
---
simplix:
  cache:
    mode: local
    default-ttl-seconds: 300  # 5 minutes

# ============================================================================
# Example 2: Redis Cache for Production
# ============================================================================
---
simplix:
  cache:
    mode: redis
    default-ttl-seconds: 3600
    redis:
      key-prefix: "myapp:cache:"

spring:
  data:
    redis:
      host: redis.production.example.com
      port: 6379
      password: ${REDIS_PASSWORD}
      ssl:
        enabled: true

# ============================================================================
# Example 3: Multi-Environment Configuration
# ============================================================================
---
# Default configuration
simplix:
  cache:
    mode: ${CACHE_MODE:local}
    default-ttl-seconds: ${CACHE_TTL:3600}

---
# Development environment
spring:
  config:
    activate:
      on-profile: dev

simplix:
  cache:
    mode: local
    max-size: 1000
    cache-configs:
      userSessions:
        ttl-seconds: 300  # 5 minutes for dev

---
# Staging environment
spring:
  config:
    activate:
      on-profile: staging

simplix:
  cache:
    mode: redis
    redis:
      key-prefix: "staging:cache:"
---
spring:
  data:
    redis:
      host: redis-staging.example.com

---
# Production environment
spring:
  config:
    activate:
      on-profile: prod
---
simplix:
  cache:
    mode: redis
    redis:
      key-prefix: "prod:cache:"
      enable-statistics: true
---
spring:
  data:
    redis:
      host: redis-prod.example.com
      ssl:
        enabled: true
      lettuce:
        pool:
          max-active: 16
          max-idle: 8

# ============================================================================
# Example 4: Custom Cache Configurations
# ============================================================================
---
simplix:
  cache:
    mode: redis
    default-ttl-seconds: 3600
    cache-configs:
      # Short-lived cache for real-time data
      realTimeData:
        ttl-seconds: 10
        max-size: 100

      # Medium-lived cache for user data
      userData:
        ttl-seconds: 900  # 15 minutes
        max-size: 5000

      # Long-lived cache for reference data
      referenceData:
        ttl-seconds: 86400  # 24 hours
        max-size: 10000

      # Security-sensitive cache
      authTokens:
        ttl-seconds: 300  # 5 minutes
        max-size: 1000

      # Session cache
      sessions:
        ttl-seconds: 3600  # 1 hour
        max-size: 10000

# ============================================================================
# Example 5: Redis Cluster Configuration
# ============================================================================
---
simplix:
  cache:
    mode: redis
---
spring:
  data:
    redis:
      cluster:
        nodes:
          - redis-node1.example.com:6379
          - redis-node2.example.com:6379
          - redis-node3.example.com:6379
        max-redirects: 3
      password: ${REDIS_PASSWORD}

# ============================================================================
# Example 6: Redis Sentinel Configuration
# ============================================================================
---
simplix:
  cache:
    mode: redis
---
spring:
  data:
    redis:
      sentinel:
        master: mymaster
        nodes:
          - sentinel1.example.com:26379
          - sentinel2.example.com:26379
          - sentinel3.example.com:26379
      password: ${REDIS_PASSWORD}

# ============================================================================
# Example 7: Monitoring and Metrics
# ============================================================================
---
simplix:
  cache:
    mode: redis
    metrics:
      enabled: true
      collection-interval-seconds: 60  # Collect metrics every minute
---
management:
  endpoints:
    web:
      exposure:
        include: health,metrics,cache
  metrics:
    export:
      prometheus:
        enabled: true

# ============================================================================
# Example 8: Testing Configuration
# ============================================================================
---
simplix:
  cache:
    mode: local
    default-ttl-seconds: 60  # Short TTL for tests
    max-size: 100           # Small cache for tests
    cache-null-values: true  # Test null handling
    metrics:
      enabled: false        # Disable metrics in tests

# ============================================================================
# Example 9: Docker Compose Configuration
# ============================================================================
---
simplix:
  cache:
    mode: redis

spring:
  data:
    redis:
      host: ${REDIS_HOST:redis}  # 'redis' is the service name in docker-compose
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}

# ============================================================================
# Example 10: Kubernetes Configuration
# ============================================================================
---
simplix:
  cache:
    mode: redis
    redis:
      key-prefix: "${POD_NAMESPACE}:cache:"  # Use namespace as prefix

spring:
  data:
    redis:
      host: redis-service.${POD_NAMESPACE}.svc.cluster.local
      port: 6379
      password: ${REDIS_PASSWORD}

# ============================================================================
# Example 11: AWS ElastiCache Configuration
# ============================================================================
---
simplix:
  cache:
    mode: redis

spring:
  data:
    redis:
      host: my-cache-cluster.abc123.cache.amazonaws.com
      port: 6379
      ssl:
        enabled: true
      lettuce:
        pool:
          max-active: 10
          max-idle: 5
          min-idle: 2

# ============================================================================
# Example 12: Azure Cache for Redis Configuration
# ============================================================================
---
simplix:
  cache:
    mode: redis

spring:
  data:
    redis:
      host: my-cache.redis.cache.windows.net
      port: 6380
      password: ${AZURE_REDIS_KEY}
      ssl:
        enabled: true
      timeout: 5000ms

# ============================================================================
# Example 13: Complete Production Configuration
# ============================================================================
---
# Import default cache settings
spring:
  config:
    import: classpath:application-cache.yml

# Override for production
simplix:
  cache:
    mode: redis
    default-ttl-seconds: 3600
    cache-null-values: false
    cache-configs:
      # User-related caches
      userProfiles:
        ttl-seconds: 1800  # 30 minutes
        max-size: 10000
      userPermissions:
        ttl-seconds: 900   # 15 minutes
        max-size: 5000
      userSessions:
        ttl-seconds: 3600  # 1 hour
        max-size: 20000

      # Application caches
      applicationConfig:
        ttl-seconds: 300   # 5 minutes
        max-size: 100
      featureFlags:
        ttl-seconds: 60    # 1 minute
        max-size: 50

      # Reference data caches
      countries:
        ttl-seconds: 86400  # 24 hours
        max-size: 300
      currencies:
        ttl-seconds: 86400  # 24 hours
        max-size: 200
      timezones:
        ttl-seconds: 86400  # 24 hours
        max-size: 500

    metrics:
      enabled: true
      collection-interval-seconds: 300  # 5 minutes

    redis:
      key-prefix: "prod:v1:"
      use-key-prefix: true
      command-timeout: 3000
      enable-statistics: true
---
spring:
  data:
    redis:
      host: redis-primary.prod.example.com
      port: 6379
      password: ${REDIS_PASSWORD}
      database: 0
      ssl:
        enabled: true
      connect-timeout: 5000ms
      timeout: 3000ms
      lettuce:
        pool:
          max-active: 20
          max-idle: 10
          min-idle: 5
          max-wait: 5000ms
          time-between-eviction-runs: 60s
        shutdown-timeout: 200ms

# Health check configuration
management:
  health:
    redis:
      enabled: true
  endpoints:
    web:
      exposure:
        include: health,metrics,cache,info
  endpoint:
    health:
      show-details: when-authorized

# Logging configuration
logging:
  level:
    dev.simplecore.simplix.cache: INFO
    org.springframework.data.redis: WARN
    io.lettuce.core: WARN